{"version":3,"file":"index-4LLPZTDq.js","sources":["../../src/api.ts","../../src/message-parser.ts","../../assets/send.svg?raw","../../assets/question.svg?raw","../../assets/lightbulb.svg?raw","../../assets/new-chat.svg?raw","../../src/components/debug.ts","../../src/components/chat.ts"],"sourcesContent":["import { type ChatResponse, type ChatRequestOptions, type ChatResponseChunk } from './models.js';\n\nexport const apiBaseUrl = import.meta.env.VITE_BACKEND_API_URI || '';\n\nexport async function getCompletion(options: ChatRequestOptions) {\n  const apiUrl = options.apiUrl || apiBaseUrl;\n  const response = await fetch(`${apiUrl}/chat`, {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify({\n      messages: options.messages,\n      stream: options.stream,\n      context: {\n        top: options.top,\n        temperature: options.temperature,\n      },\n    }),\n  });\n\n  if (options.stream) {\n    return getChunksFromResponse<ChatResponseChunk>(response as Response, options.chunkIntervalMs);\n  }\n\n  const json: ChatResponse = await response.json();\n  if (response.status > 299 || !response.ok) {\n    throw new Error(json.error || 'Unknown error');\n  }\n\n  return json;\n}\n\nexport function getCitationUrl(citation: string): string {\n  return `${apiBaseUrl}/content/${citation}`;\n}\n\nexport class NdJsonParserStream extends TransformStream<string, JSON> {\n  private buffer: string = '';\n  constructor() {\n    let controller: TransformStreamDefaultController<JSON>;\n    super({\n      start: (_controller) => {\n        controller = _controller;\n      },\n      transform: (chunk) => {\n        const jsonChunks = chunk.split('\\n').filter(Boolean);\n        for (const jsonChunk of jsonChunks) {\n          try {\n            this.buffer += jsonChunk;\n            controller.enqueue(JSON.parse(this.buffer));\n            this.buffer = '';\n          } catch {\n            // Invalid JSON, wait for next chunk\n          }\n        }\n      },\n    });\n  }\n}\n\nexport async function* getChunksFromResponse<T>(response: Response, intervalMs: number): AsyncGenerator<T, void> {\n  const reader = response.body?.pipeThrough(new TextDecoderStream()).pipeThrough(new NdJsonParserStream()).getReader();\n  if (!reader) {\n    throw new Error('No response body or body is not readable');\n  }\n\n  let value: JSON | undefined;\n  let done: boolean;\n  while ((({ value, done } = await reader.read()), !done)) {\n    yield new Promise<T>((resolve) => {\n      setTimeout(() => {\n        resolve(value as T);\n      }, intervalMs);\n    });\n  }\n}\n","import { type HTMLTemplateResult, html, nothing } from 'lit';\nimport { type ChatMessage, type ChatMessageContext } from './models.js';\n\nexport type ParsedMessage = {\n  html: HTMLTemplateResult;\n  citations: string[];\n  followupQuestions: string[];\n  role: string;\n  context?: ChatMessageContext;\n};\n\nexport function parseMessageIntoHtml(\n  message: ChatMessage,\n  renderCitationReference: (citation: string, index: number) => HTMLTemplateResult,\n): ParsedMessage {\n  if (message.role === 'user') {\n    return {\n      html: html`${message.content}`,\n      citations: [],\n      followupQuestions: [],\n      role: message.role,\n      context: message.context,\n    };\n  }\n\n  const citations: string[] = [];\n  const followupQuestions: string[] = [];\n\n  // Extract any follow-up questions that might be in the message\n  const text = message.content\n    .replaceAll(/<<([^>]+)>>/g, (_match, content) => {\n      followupQuestions.push(content);\n      return '';\n    })\n    .split('<<')[0] // Truncate incomplete questions\n    .trim();\n\n  // Extract any citations that might be in the message\n  const parts = text.split(/\\[([^\\]]+)]/g);\n  const result = html`${parts.map((part, index) => {\n    if (index % 2 === 0) {\n      return html`${part}`;\n    } else if (index + 1 < parts.length) {\n      // Handle only completed citations\n      let citationIndex = citations.indexOf(part);\n      if (citationIndex === -1) {\n        citations.push(part);\n        citationIndex = citations.length;\n      } else {\n        citationIndex++;\n      }\n      return renderCitationReference(part, citationIndex);\n    } else {\n      return nothing;\n    }\n  })}`;\n\n  return {\n    html: result,\n    citations,\n    followupQuestions,\n    role: message.role,\n    context: message.context,\n  };\n}\n","export default \"<svg viewBox=\\\"0 0 24 24\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><path d=\\\"M5.69362 11.9997L2.29933 3.2715C2.0631 2.66403 2.65544 2.08309 3.2414 2.28959L3.33375 2.32885L21.3337 11.3288C21.852 11.588 21.8844 12.2975 21.4309 12.6129L21.3337 12.6705L3.33375 21.6705C2.75077 21.962 2.11746 21.426 2.2688 20.8234L2.29933 20.7278L5.69362 11.9997L2.29933 3.2715L5.69362 11.9997ZM4.4021 4.54007L7.01109 11.2491L13.6387 11.2497C14.0184 11.2497 14.3322 11.5318 14.3818 11.8979L14.3887 11.9997C14.3887 12.3794 14.1065 12.6932 13.7404 12.7428L13.6387 12.7497L7.01109 12.7491L4.4021 19.4593L19.3213 11.9997L4.4021 4.54007Z\\\"></path></svg>\"","export default \"<svg viewBox=\\\"0 0 24 24\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><path d=\\\"M12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C10.3817 22 8.81782 21.6146 7.41286 20.888L3.58704 21.9553C2.92212 22.141 2.23258 21.7525 2.04691 21.0876C1.98546 20.8676 1.98549 20.6349 2.04695 20.4151L3.11461 16.5922C2.38637 15.186 2 13.6203 2 12C2 6.47715 6.47715 2 12 2ZM12 3.5C7.30558 3.5 3.5 7.30558 3.5 12C3.5 13.4696 3.87277 14.8834 4.57303 16.1375L4.72368 16.4072L3.61096 20.3914L7.59755 19.2792L7.86709 19.4295C9.12006 20.1281 10.5322 20.5 12 20.5C16.6944 20.5 20.5 16.6944 20.5 12C20.5 7.30558 16.6944 3.5 12 3.5ZM12 15.5C12.5523 15.5 13 15.9477 13 16.5C13 17.0523 12.5523 17.5 12 17.5C11.4477 17.5 11 17.0523 11 16.5C11 15.9477 11.4477 15.5 12 15.5ZM12 6.75C13.5188 6.75 14.75 7.98122 14.75 9.5C14.75 10.5108 14.4525 11.074 13.6989 11.8586L13.5303 12.0303C12.9084 12.6522 12.75 12.9163 12.75 13.5C12.75 13.9142 12.4142 14.25 12 14.25C11.5858 14.25 11.25 13.9142 11.25 13.5C11.25 12.4892 11.5475 11.926 12.3011 11.1414L12.4697 10.9697C13.0916 10.3478 13.25 10.0837 13.25 9.5C13.25 8.80964 12.6904 8.25 12 8.25C11.3528 8.25 10.8205 8.74187 10.7565 9.37219L10.75 9.5C10.75 9.91421 10.4142 10.25 10 10.25C9.58579 10.25 9.25 9.91421 9.25 9.5C9.25 7.98122 10.4812 6.75 12 6.75Z\\\"></path></svg>\"","export default \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"24\\\" height=\\\"24\\\" viewBox=\\\"0 0 24 24\\\"><path d=\\\"M11.25 6.75073C11.25 6.33652 11.5858 6.00073 12 6.00073C12.4142 6.00073 12.75 6.33652 12.75 6.75073V8.25076C12.75 8.66498 12.4142 9.00076 12 9.00076C11.5858 9.00076 11.25 8.66498 11.25 8.25076V6.75073ZM16.2803 8.21607C15.9874 7.92318 15.5126 7.92318 15.2197 8.21607L14.159 9.27675C13.8661 9.56964 13.8661 10.0445 14.159 10.3374C14.4519 10.6303 14.9268 10.6303 15.2197 10.3374L16.2803 9.27673C16.5732 8.98384 16.5732 8.50896 16.2803 8.21607ZM8.78032 8.21607C8.48743 7.92318 8.01255 7.92318 7.71966 8.21607C7.42677 8.50896 7.42677 8.98384 7.71966 9.27673L8.78034 10.3374C9.07324 10.6303 9.54811 10.6303 9.841 10.3374C10.1339 10.0445 10.1339 9.56964 9.841 9.27675L8.78032 8.21607ZM12 2.00098C16.0041 2.00098 19.25 5.24691 19.25 9.25098C19.25 11.347 18.3493 13.2707 16.5869 14.9929C16.51 15.0681 16.4504 15.1586 16.4118 15.2582L16.3804 15.3605L15.2493 20.2561C15.0266 21.22 14.2035 21.9183 13.2302 21.993L13.057 21.9996H10.9433C9.95374 21.9996 9.08791 21.3545 8.79629 20.4228L8.75088 20.2555L7.62132 15.3607C7.58904 15.2208 7.51728 15.0931 7.41456 14.9928C5.73515 13.3526 4.83778 11.5297 4.75613 9.54923L4.75 9.25098L4.75388 9.01166C4.88014 5.11837 8.07601 2.00098 12 2.00098ZM14.115 18.499H9.884L10.2125 19.9182C10.2831 20.2245 10.5357 20.4504 10.8401 20.4925L10.9433 20.4996H13.057C13.3713 20.4996 13.6481 20.3044 13.7577 20.0174L13.7878 19.9184L14.115 18.499ZM12 3.50098C8.89821 3.50098 6.37006 5.95699 6.25415 9.03042L6.25 9.25098L6.25672 9.52799C6.33286 11.0913 7.05722 12.5471 8.46262 13.9197C8.72675 14.1777 8.92265 14.496 9.03422 14.846L9.08291 15.0235L9.538 16.999H11.25V10.7503C11.25 10.3361 11.5858 10.0003 12 10.0003C12.4142 10.0003 12.75 10.3361 12.75 10.7503V16.999H14.461L14.9189 15.0228C15.0019 14.6634 15.1718 14.3309 15.4124 14.0539L15.5386 13.9201C16.9432 12.5475 17.6672 11.0916 17.7433 9.52803L17.75 9.25098L17.7458 9.03042C17.6299 5.95699 15.1018 3.50098 12 3.50098Z\\\"/></svg>\"","export default \"<svg viewBox=\\\"0 0 24 24\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><path d=\\\"M12 2C17.5228 2 22 6.47715 22 12C22 12.2628 21.9899 12.5232 21.97 12.7809C21.5319 12.3658 21.0361 12.0111 20.4958 11.73C20.3532 7.16054 16.6041 3.5 12 3.5C7.30558 3.5 3.5 7.30558 3.5 12C3.5 13.4696 3.87277 14.8834 4.57303 16.1375L4.72368 16.4072L3.61096 20.3914L7.59755 19.2792L7.86709 19.4295C9.04305 20.0852 10.3592 20.4531 11.73 20.4958C12.0111 21.0361 12.3658 21.5319 12.7809 21.97C12.5232 21.9899 12.2628 22 12 22C10.3817 22 8.81782 21.6146 7.41286 20.888L3.58704 21.9553C2.92212 22.141 2.23258 21.7525 2.04691 21.0876C1.98546 20.8676 1.98549 20.6349 2.04695 20.4151L3.11461 16.5922C2.38637 15.186 2 13.6203 2 12C2 6.47715 6.47715 2 12 2ZM23 17.5C23 14.4624 20.5376 12 17.5 12C14.4624 12 12 14.4624 12 17.5C12 20.5376 14.4624 23 17.5 23C20.5376 23 23 20.5376 23 17.5ZM18.0006 18L18.0011 20.5035C18.0011 20.7797 17.7773 21.0035 17.5011 21.0035C17.225 21.0035 17.0011 20.7797 17.0011 20.5035L17.0006 18H14.4956C14.2197 18 13.9961 17.7762 13.9961 17.5C13.9961 17.2239 14.2197 17 14.4956 17H17.0005L17 14.4993C17 14.2231 17.2239 13.9993 17.5 13.9993C17.7761 13.9993 18 14.2231 18 14.4993L18.0005 17H20.4966C20.7725 17 20.9961 17.2239 20.9961 17.5C20.9961 17.7762 20.7725 18 20.4966 18H18.0006Z\\\"></path></svg>\"","/* eslint-disable unicorn/template-indent */\nimport { LitElement, css, html } from 'lit';\nimport { map } from 'lit/directives/map.js';\nimport { customElement, property } from 'lit/decorators.js';\nimport { unsafeHTML } from 'lit/directives/unsafe-html.js';\nimport { type ChatDebugDetails } from '../models.js';\n\nexport type DebugComponentOptions = {\n  strings: {\n    thoughtsTitle: string;\n    supportingContentTitle: string;\n  };\n};\n\n@customElement('azc-debug')\nexport class DebugComponent extends LitElement {\n  @property({ type: Object }) details: ChatDebugDetails = { thoughts: '', dataPoints: [] };\n  @property({ type: Object }) options!: DebugComponentOptions;\n  @property({ type: Boolean }) showThoughtProcess = true;\n\n  protected renderThoughtProcess = (thoughtProcess: string) => {\n    return html`${unsafeHTML(thoughtProcess)}`;\n  };\n\n  protected renderDataPoints = (dataPoints: string[]) => {\n    const infos = dataPoints.map((dataPoint) => {\n      const [title, ...extract] = dataPoint.split(':');\n      return { title, extract: extract.join(':') };\n    });\n    return html`<div class=\"data-points\">\n      ${map(\n        infos,\n        (info) =>\n          html`<div class=\"card\">\n            <div class=\"title\">${info.title}</div>\n            <div>${info.extract}</div>\n          </div>`,\n      )}\n    </div>`;\n  };\n\n  protected override render() {\n    return html`<aside class=\"debug-container\">\n      <slot name=\"close-button\"></slot>\n      <nav class=\"nav\">\n        <button class=${this.showThoughtProcess ? 'active' : ''} @click=${() => (this.showThoughtProcess = true)}>\n          ${this.options.strings.thoughtsTitle}\n        </button>\n        <button class=${this.showThoughtProcess ? '' : 'active'} @click=${() => (this.showThoughtProcess = false)}>\n          ${this.options.strings.supportingContentTitle}\n        </button>\n      </nav>\n      <section class=\"content\">\n        ${this.showThoughtProcess\n          ? this.renderThoughtProcess(this.details.thoughts)\n          : this.renderDataPoints(this.details.dataPoints)}\n      </section>\n    </aside>`;\n  }\n\n  static override styles = css`\n    *:focus-visible {\n      outline: var(--focus-outline) var(--primary);\n    }\n    button {\n      padding: var(--space-md);\n      font-size: 1rem;\n      outline: var(--focus-outline) transparent;\n      transition: outline 0.3s ease;\n      border: none;\n\n      &:not(:disabled) {\n        cursor: pointer;\n      }\n      &:hover:not(:disabled) {\n        // TODO: separate out hover style\n        background: var(--submit-button-bg-hover);\n      }\n    }\n    .active {\n      border-bottom: 3px solid var(--primary);\n    }\n    .nav {\n      padding-bottom: var(--space-md);\n    }\n    .debug-container {\n      position: absolute;\n      inset: var(--space-xl);\n      display: flex;\n      flex-direction: column;\n      border-radius: var(--border-radius);\n      background: var(--bg);\n      overflow: hidden;\n      padding: var(--space-xl);\n      margin: 0px auto;\n      max-width: 1024px;\n    }\n    .content {\n      flex: 1;\n      display: flex;\n      flex-direction: column;\n      overflow: auto;\n    }\n    .title {\n      font-weight: bold;\n      margin-bottom: var(--space-md);\n    }\n    .card {\n      padding: var(--space-md);\n      margin-bottom: var(--space-md);\n      border-radius: var(--border-radius);\n      // TODO: separate out card styles\n      color: var(--bot-message-color);\n      background: var(--bot-message-bg);\n      border: var(--bot-message-border);\n      box-shadow: var(--card-shadow);\n    }\n  `;\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'azc-debug': DebugComponent;\n  }\n}\n","/* eslint-disable unicorn/template-indent */\nimport { LitElement, css, html, nothing } from 'lit';\nimport { map } from 'lit/directives/map.js';\nimport { repeat } from 'lit/directives/repeat.js';\nimport { unsafeSVG } from 'lit/directives/unsafe-svg.js';\nimport { customElement, property, state, query } from 'lit/decorators.js';\nimport {\n  type ChatRequestOptions,\n  type ChatResponse,\n  type ChatMessage,\n  type ChatResponseChunk,\n  type ChatDebugDetails,\n  type ChatMessageContext,\n} from '../models.js';\nimport { getCitationUrl, getCompletion } from '../api.js';\nimport { type ParsedMessage, parseMessageIntoHtml } from '../message-parser.js';\nimport sendSvg from '../../assets/send.svg?raw';\nimport questionSvg from '../../assets/question.svg?raw';\nimport lightbulbSvg from '../../assets/lightbulb.svg?raw';\nimport newChatSvg from '../../assets/new-chat.svg?raw';\nimport './debug.js';\n\nexport type ChatComponentState = {\n  hasError: boolean;\n  isLoading: boolean;\n  isStreaming: boolean;\n};\n\nexport type ChatComponentOptions = ChatRequestOptions & {\n  enablePromptSuggestions: boolean;\n  enableContentLinks: boolean;\n  promptSuggestions: string[];\n  apiUrl?: string;\n  strings: {\n    promptSuggestionsTitle: string;\n    citationsTitle: string;\n    followUpQuestionsTitle: string;\n    showThoughtProcessTitle: string;\n    closeTitle: string;\n    thoughtsTitle: string;\n    supportingContentTitle: string;\n    chatInputPlaceholder: string;\n    chatInputButtonLabel: string;\n    assistant: string;\n    user: string;\n    errorMessage: string;\n    newChatButton: string;\n    retryButton: string;\n  };\n};\n\nexport const defaultOptions: ChatComponentOptions = {\n  enableContentLinks: false,\n  stream: false,\n  chunkIntervalMs: 30,\n  apiUrl: '',\n  enablePromptSuggestions: true,\n  promptSuggestions: [\n    'How to search and book rentals?',\n    'What is the refund policy?',\n    'How to contact a representative?',\n  ],\n  messages: [],\n  strings: {\n    promptSuggestionsTitle: 'Ask anything or try an example',\n    citationsTitle: 'Citations:',\n    followUpQuestionsTitle: 'Follow-up questions:',\n    showThoughtProcessTitle: 'Show thought process',\n    closeTitle: 'Close',\n    thoughtsTitle: 'Thought process',\n    supportingContentTitle: 'Supporting Content',\n    chatInputPlaceholder: 'Ask me anything...',\n    chatInputButtonLabel: 'Send question',\n    assistant: 'Support Assistant',\n    user: 'You',\n    errorMessage: 'We are currently experiencing an issue.',\n    newChatButton: 'New chat',\n    retryButton: 'Retry',\n  },\n};\n\n/**\n * A chat component that allows the user to ask questions and get answers from an API.\n * The component also displays default prompts that the user can click on to ask a question.\n * The component is built as a custom element that extends LitElement.\n *\n * Labels and other aspects are configurable via the `option` property.\n * @element azc-chat\n * @fires messagesUpdated - Fired when the message thread is updated\n * @fires stateChanged - Fired when the state of the component changes\n * */\n@customElement('azc-chat')\nexport class ChatComponent extends LitElement {\n  @property({\n    type: Object,\n    converter: (value) => ({ ...defaultOptions, ...JSON.parse(value || '{}') }),\n  })\n  options: ChatComponentOptions = defaultOptions;\n\n  @property() question = '';\n  @property({ type: Array }) messages: ChatMessage[] = [];\n  @state() protected hasError = false;\n  @state() protected isLoading = false;\n  @state() protected isStreaming = false;\n  @state() protected debugDetails?: ChatDebugDetails;\n  @query('.messages') protected messagesElement;\n  @query('.chat-input') protected chatInputElement;\n\n  onSuggestionClicked(suggestion: string) {\n    this.question = suggestion;\n    this.onSendClicked();\n  }\n\n  onCitationClicked(citation: string) {\n    if (this.options.enableContentLinks) {\n      const path = getCitationUrl(citation);\n      window.open(path, '_blank');\n    } else {\n      // TODO: open debug details\n    }\n  }\n\n  onKeyPressed(event: KeyboardEvent) {\n    if (event.key === 'Enter') {\n      event.preventDefault();\n      this.onSendClicked();\n    }\n  }\n\n  onShowDebugClicked(context: ChatMessageContext = {}) {\n    this.debugDetails = {\n      thoughts: context.thoughts ?? '',\n      dataPoints: context.data_points ?? [],\n    };\n  }\n\n  async onSendClicked(isRetry = false) {\n    if (this.isLoading) return;\n\n    this.hasError = false;\n    if (!isRetry) {\n      this.messages = [\n        ...this.messages,\n        {\n          content: this.question,\n          role: 'user',\n        },\n      ];\n    }\n    this.question = '';\n    this.isLoading = true;\n    this.scrollToLastMessage();\n    try {\n      const response = await getCompletion({ ...this.options, messages: this.messages });\n      if (this.options.stream) {\n        this.isStreaming = true;\n        const chunks = response as AsyncGenerator<ChatResponseChunk>;\n        const messages = this.messages;\n        const message: ChatMessage = {\n          content: '',\n          role: 'assistant',\n          context: {\n            data_points: [],\n            thoughts: '',\n          },\n        };\n        for await (const chunk of chunks) {\n          if (chunk.choices[0].delta.context?.data_points) {\n            message.context!.data_points = chunk.choices[0].delta.context?.data_points;\n            message.context!.thoughts = chunk.choices[0].delta.context?.thoughts ?? '';\n          } else if (chunk.choices[0].delta.content) {\n            message.content += chunk.choices[0].delta.content;\n            this.messages = [...messages, message];\n            this.scrollToLastMessage();\n          }\n        }\n      } else {\n        const chatResponse = response as ChatResponse;\n        this.messages = [...this.messages, chatResponse.choices[0].message];\n        this.scrollToLastMessage();\n      }\n\n      this.isLoading = false;\n      this.isStreaming = false;\n    } catch (error) {\n      this.hasError = true;\n      this.isLoading = false;\n      this.isStreaming = false;\n      console.error(error);\n    }\n  }\n\n  override requestUpdate(name?: string, oldValue?: any) {\n    if (name === 'messages') {\n      const messagesUpdatedEvent = new CustomEvent('messagesUpdated', {\n        detail: { messages: this.messages },\n        bubbles: true,\n      });\n      this.dispatchEvent(messagesUpdatedEvent);\n    } else if (name === 'hasError' || name === 'isLoading' || name === 'isStreaming') {\n      const state = {\n        hasError: this.hasError,\n        isLoading: this.isLoading,\n        isStreaming: this.isStreaming,\n      };\n      const stateUpdatedEvent = new CustomEvent('stateChanged', {\n        detail: { state },\n        bubbles: true,\n      });\n      this.dispatchEvent(stateUpdatedEvent);\n    }\n\n    return super.requestUpdate(name, oldValue);\n  }\n\n  protected scrollToLastMessage() {\n    // Need to be delayed to run after the DOM refresh\n    setTimeout(() => {\n      const { bottom } = this.messagesElement.getBoundingClientRect();\n      const { top } = this.chatInputElement.getBoundingClientRect();\n      if (bottom > top) {\n        window.scrollBy(0, bottom - top);\n      }\n    }, 0);\n  }\n\n  protected renderSuggestions = (suggestions: string[]) => {\n    return html`\n      <section class=\"suggestions-container\">\n        <h2>${this.options.strings.promptSuggestionsTitle}</h2>\n        <div class=\"suggestions\">\n          ${map(\n            suggestions,\n            (suggestion) => html`\n              <button class=\"suggestion\" @click=${() => this.onSuggestionClicked(suggestion)}>${suggestion}</button>\n            `,\n          )}\n        </div>\n      </section>\n    `;\n  };\n\n  protected renderLoader = () => {\n    return this.isLoading && !this.isStreaming\n      ? html`\n          <div class=\"message assistant loader\">\n            <div class=\"message-body\">\n              <slot name=\"loader\"><div class=\"loader-animation\"></div></slot>\n              <div class=\"message-role\">${this.options.strings.assistant}</div>\n            </div>\n          </div>\n        `\n      : nothing;\n  };\n\n  protected renderMessage = (message: ParsedMessage) => {\n    return html`\n      <div class=\"message ${message.role} animation\">\n        ${message.role === 'assistant'\n          ? html`<slot name=\"message-header\">\n              <div class=\"debug-buttons\">\n                <button\n                  class=\"button\"\n                  @click=${() => this.onShowDebugClicked(message.context)}\n                  title=${this.options.strings.showThoughtProcessTitle}\n                >\n                  ${unsafeSVG(lightbulbSvg)}\n                </button>\n              </div>\n            </slot>`\n          : nothing}\n        <div class=\"message-body\">\n          <div class=\"content\">${message.html}</div>\n          ${message.citations.length > 0\n            ? html`\n                <div class=\"citations\">\n                  <div class=\"citations-title\">${this.options.strings.citationsTitle}</div>\n                  ${map(message.citations, this.renderCitation)}\n                </div>\n              `\n            : nothing}\n        </div>\n        <div class=\"message-role\">\n          ${message.role === 'user' ? this.options.strings.user : this.options.strings.assistant}\n        </div>\n      </div>\n    `;\n  };\n\n  protected renderError = () => {\n    return html`\n      <div class=\"message assistant error\">\n        <div class=\"message-body\">\n          <span class=\"error-message\">${this.options.strings.errorMessage}</span>\n          <button @click=${() => this.onSendClicked(true)}>${this.options.strings.retryButton}</button>\n        </div>\n      </div>\n    `;\n  };\n\n  protected renderCitation = (citation: string, index: number) => {\n    return html`<button class=\"citation\" @click=${() => this.onCitationClicked(citation)}>\n      ${index + 1}. ${citation}\n    </button>`;\n  };\n\n  protected renderCitationLink = (citation: string, index: number) => {\n    return html`<button class=\"citation-link\" @click=${() => this.onCitationClicked(citation)}>\n      <sup>[${index}]</sup>\n    </button>`;\n  };\n\n  protected renderFollowupQuestions = (questions: string[]) => {\n    return questions.length > 0\n      ? html`\n          <div class=\"questions\">\n            <span class=\"question-icon\" title=${this.options.strings.followUpQuestionsTitle}>\n              ${unsafeSVG(questionSvg)} </span\n            >${map(\n              questions,\n              (question) => html`\n                <button class=\"question animation\" @click=${() => this.onSuggestionClicked(question)}>\n                  ${question}\n                </button>\n              `,\n            )}\n          </div>\n        `\n      : nothing;\n  };\n\n  protected renderChatInput = () => {\n    return html`\n      <div class=\"chat-input\">\n        <button\n          class=\"button new-chat-button\"\n          @click=${() => (this.messages = [])}\n          title=${this.options.strings.newChatButton}\n          .disabled=${this.messages?.length === 0 || this.isLoading || this.isStreaming}\n        >\n          ${unsafeSVG(newChatSvg)}\n        </button>\n        <form class=\"input-form\">\n          <textarea\n            class=\"text-input\"\n            placeholder=\"${this.options.strings.chatInputPlaceholder}\"\n            .value=${this.question}\n            autocomplete=\"off\"\n            @input=${(event) => (this.question = event.target.value)}\n            @keypress=${this.onKeyPressed}\n            .disabled=${this.isLoading}\n          ></textarea>\n          <button\n            class=\"submit-button\"\n            @click=${() => this.onSendClicked()}\n            title=\"${this.options.strings.chatInputButtonLabel}\"\n            .disabled=${this.isLoading || !this.question}\n          >\n            ${unsafeSVG(sendSvg)}\n          </button>\n        </form>\n      </div>\n    `;\n  };\n\n  protected override render() {\n    const parsedMessages = this.messages.map((message) => parseMessageIntoHtml(message, this.renderCitationLink));\n    return html`\n      <section class=\"chat-container\">\n        ${this.options.enablePromptSuggestions &&\n        this.options.promptSuggestions.length > 0 &&\n        this.messages.length === 0\n          ? this.renderSuggestions(this.options.promptSuggestions)\n          : nothing}\n        <div class=\"messages\">\n          ${repeat(parsedMessages, (_, index) => index, this.renderMessage)} ${this.renderLoader()}\n          ${this.hasError ? this.renderError() : nothing}\n          ${this.renderFollowupQuestions(parsedMessages.at(-1)?.followupQuestions ?? [])}\n        </div>\n        ${this.renderChatInput()}\n      </section>\n      ${this.debugDetails\n        ? html`<section class=\"debug-details\">\n            <azc-debug .details=${this.debugDetails} .options=${this.options}>\n              <button\n                slot=\"close-button\"\n                class=\"button close-button\"\n                @click=${() => (this.debugDetails = undefined)}\n                title=${this.options.strings.closeTitle}\n              >\n                X\n              </button>\n            </azc-debug>\n          </section>`\n        : nothing}\n    `;\n  }\n\n  static override styles = css`\n    :host {\n      /* Base properties */\n      --primary: var(--azc-primary, #07f);\n      --error: var(--azc-error, #e30);\n      --text-color: var(--azc-text-color, #000);\n      --text-invert-color: var(--azc--text-invert-color, #fff);\n      --disabled-color: var(--azc-disabled-color, #ccc);\n      --bg: var(--azc-bg, #eee);\n      --card-bg: var(--azc-card-bg, #fff);\n      --card-shadow: var(--azc-card-shadow, 0 0.3px 0.9px rgba(0 0 0 / 12%), 0 1.6px 3.6px rgba(0 0 0 / 16%));\n      --space-md: var(--azc-space-md, 12px);\n      --space-xl: var(--azc-space-xl, calc(var(--space-md) * 2));\n      --space-xs: var(--azc-space-xs, calc(var(--space-md) / 2));\n      --space-xxs: var(--azc-space-xs, calc(var(--space-md) / 4));\n      --border-radius: var(--azc-border-radius, 16px);\n      --focus-outline: var(--azc-focus-outline, 2px solid);\n      --overlay-color: var(--azc-overlay-color, rgba(0 0 0 / 40%));\n\n      /* Component-specific properties */\n      --error-color: var(--azc-error-color, var(--error));\n      --error-border: var(--azc-error-border, none);\n      --error-bg: var(--azc-error-bg, var(--card-bg));\n      --retry-button-color: var(--azc-retry-button-color, var(--text-color));\n      --retry-button-bg: var(--azc-retry-button-bg, #f0f0f0);\n      --retry-button-bg-hover: var(--azc-retry-button-bg, #e5e5e5);\n      --retry-button-border: var(--azc-retry-button-border, none);\n      --suggestion-color: var(--azc-suggestion-color, var(--text-color));\n      --suggestion-border: var(--azc-suggestion-border, none);\n      --suggestion-bg: var(--azc-suggestion-bg, var(--card-bg));\n      --suggestion-shadow: var(--azc-suggestion-shadow, 0 6px 16px -1.5px rgba(141 141 141 / 30%));\n      --user-message-color: var(--azc-user-message-color, var(--text-invert-color));\n      --user-message-border: var(--azc-user-message-border, none);\n      --user-message-bg: var(--azc-user-message-bg, var(--primary));\n      --bot-message-color: var(--azc-bot-message-color, var(--text-color));\n      --bot-message-border: var(--azc-bot-message-border, none);\n      --citation-color: var(--azc-citation-color, var(--text-invert-color));\n      --bot-message-bg: var(--azc-bot-message-bg, var(--card-bg));\n      --citation-bg: var(--azc-citation-bg, var(--primary));\n      --citation-bg-hover: var(--azc-citation-bg, color-mix(in srgb, var(--primary), #000 10%));\n      --new-chat-button-color: var(--azc-button-color, var(--text-invert-color));\n      --new-chat-button-bg: var(--azc-new-chat-button-bg, var(--primary));\n      --new-chat-button-bg-hover: var(--azc-new-chat-button-bg, color-mix(in srgb, var(--primary), #000 10%));\n      --chat-input-color: var(--azc-chat-input-color, var(--text-color));\n      --chat-input-border: var(--azc-chat-input-border, none);\n      --chat-input-bg: var(--azc-chat-input-bg, var(--card-bg));\n      --submit-button-color: var(--azc-button-color, var(--primary));\n      --submit-button-border: var(--azc-submit-button-border, none);\n      --submit-button-bg: var(--azc-submit-button-bg, none);\n      --submit-button-bg-hover: var(--azc-submit-button-color, #f0f0f0);\n    }\n    *:focus-visible {\n      outline: var(--focus-outline) var(--primary);\n    }\n    .animation {\n      animation: 0.3s ease;\n    }\n    svg {\n      fill: currentColor;\n    }\n    button {\n      font-size: 1rem;\n      border-radius: calc(var(--border-radius) / 2);\n      outline: var(--focus-outline) transparent;\n      transition: outline 0.3s ease;\n\n      &:not(:disabled) {\n        cursor: pointer;\n      }\n    }\n    .chat-container {\n      container-type: inline-size;\n      position: relative;\n      background: var(--bg);\n      font-family:\n        'Segoe UI',\n        -apple-system,\n        BlinkMacSystemFont,\n        Roboto,\n        'Helvetica Neue',\n        sans-serif;\n    }\n    .citation-link {\n      padding: 0;\n      color: var(--primary);\n      background: none;\n      border: none;\n      white-space: normal;\n    }\n    .citation {\n      font-size: 0.85rem;\n      color: var(--citation-color);\n      background: var(--citation-bg);\n      border: var(--citation-border);\n      padding: var(--space-xxs) var(--space-xs);\n      margin-right: var(--space-xs);\n      margin-top: var(--space-xs);\n\n      &:hover {\n        background: var(--citation-bg-hover);\n      }\n    }\n    .citations-title {\n      font-weight: bold;\n    }\n    .suggestions-container {\n      text-align: center;\n      padding: var(--space-xl);\n    }\n    .suggestions {\n      display: flex;\n      gap: var(--space-md);\n    }\n    @container (width < 480px) {\n      .suggestions {\n        flex-direction: column;\n      }\n    }\n\n    .suggestion {\n      flex: 1 1 0;\n      padding: var(--space-xl) var(--space-md);\n      color: var(--sugestion-color);\n      background: var(--suggestion-bg);\n      border: var(--suggestion-border);\n      border-radius: var(--border-radius);\n      box-shadow: var(--suggestion-shadow);\n\n      &:hover {\n        outline: var(--focus-outline) var(--primary);\n      }\n    }\n    .messages {\n      padding: var(--space-xl);\n      display: flex;\n      flex-direction: column;\n      gap: var(--space-md);\n    }\n    .user {\n      align-self: end;\n      color: var(--user-message-color);\n      background: var(--user-message-bg);\n      border: var(--user-message-border);\n    }\n    .assistant {\n      color: var(--bot-message-color);\n      background: var(--bot-message-bg);\n      border: var(--bot-message-border);\n      box-shadow: var(--card-shadow);\n    }\n    .message {\n      position: relative;\n      width: auto;\n      max-width: 70%;\n      border-radius: var(--border-radius);\n      padding: var(--space-xl);\n      margin-bottom: var(--space-xl);\n      &.user {\n        animation-name: fade-in-up;\n      }\n    }\n    .message-body {\n      display: flex;\n      flex-direction: column;\n      gap: var(--space-md);\n    }\n    .content {\n      white-space: pre-line;\n    }\n    .message-role {\n      position: absolute;\n      right: var(--space-xl);\n      bottom: -1.25em;\n      color: var(--text-color);\n      font-size: 0.85rem;\n      opacity: 0.6;\n    }\n    .questions {\n      margin: var(--space-md) 0;\n      color: var(--primary);\n      text-align: right;\n    }\n    .question-icon {\n      vertical-align: middle;\n      display: inline-block;\n      height: 1.7rem;\n      width: 1.7rem;\n      margin-bottom: var(--space-xs);\n      margin-left: var(--space-xs);\n    }\n    .question {\n      position: relative;\n      padding: var(--space-xs) var(--space-md);\n      margin-bottom: var(--space-xs);\n      margin-left: var(--space-xs);\n      vertical-align: middle;\n      color: var(--primary);\n      background: var(--card-bg);\n      border: 1px solid var(--primary);\n      animation-name: fade-in-right;\n      &:hover {\n        background: color-mix(in srgb, var(--card-bg), var(--primary) 5%);\n      }\n    }\n    .debug-buttons {\n      display: flex;\n      justify-content: right;\n      gap: var(--space-md);\n      margin-bottom: var(--space-md);\n    }\n    .debug-details {\n      position: fixed;\n      inset: 0;\n      background: var(--overlay-color);\n    }\n    .button,\n    .submit-button {\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      padding: var(--space-xs);\n      border: var(--button-border);\n      background: var(--submit-button-bg);\n      color: var(--submit-button-color);\n      &:disabled {\n        color: var(--disabled-color);\n      }\n      &:hover:not(:disabled) {\n        background: var(--submit-button-bg-hover);\n      }\n    }\n    .submit-button {\n      padding: 0;\n      width: 48px;\n    }\n    .close-button {\n      position: absolute;\n      top: var(--space-md);\n      right: var(--space-md);\n      width: auto;\n      padding: var(--space-md);\n      &:hover:not(:disabled) {\n        background: var(--card-bg);\n      }\n    }\n    .error {\n      color: var(--error-color);\n      background: var(--error-bg);\n      outline: var(--focus-outline) var(--error);\n\n      & .message-body {\n        flex-direction: row;\n        align-items: center;\n      }\n\n      & button {\n        flex: 0;\n        padding: var(--space-md);\n        color: var(--retry-button-color);\n        background: var(--retry-button-bg);\n        border: var(--retry-button-border);\n\n        &:hover {\n          background: var(--retry-button-bg-hover);\n        }\n      }\n    }\n    .error-message {\n      flex: 1;\n    }\n    .chat-input {\n      --half-space-xl: calc(var(--space-xl) / 2);\n      position: sticky;\n      bottom: 0;\n      padding: var(--space-xl);\n      padding-top: var(--half-space-xl);\n      background: var(--bg);\n      box-shadow: 0 calc(-1 * var(--half-space-xl)) var(--half-space-xl) var(--bg);\n      display: flex;\n      gap: var(--space-md);\n    }\n    .new-chat-button {\n      width: 48px;\n      height: 48px;\n      padding: var(--space-md);\n      border-radius: 50%;\n      background: var(--new-chat-button-bg);\n      color: var(--new-chat-button-color);\n      font-size: 1.5rem;\n      &:hover:not(:disabled) {\n        background: var(--new-chat-button-bg-hover);\n        color: var(--new-chat-button-color);\n      }\n    }\n    .input-form {\n      display: flex;\n      flex: 1 auto;\n      background: var(--chat-input-bg);\n      border: var(--chat-input-border);\n      border-radius: var(--border-radius);\n      padding: var(--space-md);\n      box-shadow: var(--card-shadow);\n      outline: var(--focus-outline) transparent;\n      transition: outline 0.3s ease;\n\n      &:has(.text-input:focus-visible) {\n        outline: var(--focus-outline) var(--primary);\n      }\n    }\n    .text-input {\n      padding: var(--space-xs);\n      font-family: inherit;\n      font-size: 1rem;\n      flex: 1 auto;\n      height: 3rem;\n      border: none;\n      resize: none;\n      background: none;\n      &::placeholder {\n        color: var(--text-color);\n        opacity: 0.4;\n      }\n      &:focus {\n        outline: none;\n      }\n      &:disabled {\n        opacity: 0.7;\n      }\n    }\n    .loader-animation {\n      width: 100px;\n      height: 4px;\n      border-radius: var(--border-radius);\n      overflow: hidden;\n      background-color: var(--primary);\n      transform: scaleX(0);\n      transform-origin: center left;\n      animation: cubic-bezier(0.85, 0, 0.15, 1) 2s infinite load-animation;\n    }\n\n    @keyframes load-animation {\n      0% {\n        transform: scaleX(0);\n        transform-origin: center left;\n      }\n      50% {\n        transform: scaleX(1);\n        transform-origin: center left;\n      }\n      51% {\n        transform: scaleX(1);\n        transform-origin: center right;\n      }\n      100% {\n        transform: scaleX(0);\n        transform-origin: center right;\n      }\n    }\n    @keyframes fade-in-up {\n      0% {\n        opacity: 0.5;\n        top: 100px;\n      }\n      100% {\n        opacity: 1;\n        top: 0px;\n      }\n    }\n    @keyframes fade-in-right {\n      0% {\n        opacity: 0.5;\n        right: -100px;\n      }\n      100% {\n        opacity: 1;\n        right: 0;\n      }\n    }\n    @media (prefers-reduced-motion: reduce) {\n      .animation {\n        animation: none;\n      }\n    }\n  `;\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'azc-chat': ChatComponent;\n  }\n}\n"],"names":["apiBaseUrl","getCompletion","options","apiUrl","response","getChunksFromResponse","json","getCitationUrl","citation","NdJsonParserStream","controller","_controller","chunk","jsonChunks","jsonChunk","intervalMs","reader","_a","value","done","resolve","parseMessageIntoHtml","message","renderCitationReference","html","citations","followupQuestions","parts","_match","content","part","index","citationIndex","nothing","sendSvg","questionSvg","lightbulbSvg","newChatSvg","DebugComponent","LitElement","thoughtProcess","unsafeHTML","dataPoints","infos","dataPoint","title","extract","map","info","css","__decorateClass","property","customElement","defaultOptions","ChatComponent","suggestions","suggestion","unsafeSVG","questions","question","event","path","context","isRetry","chunks","messages","_b","_c","chatResponse","error","name","oldValue","messagesUpdatedEvent","state","stateUpdatedEvent","bottom","top","parsedMessages","repeat","_","query"],"mappings":"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S,CAAO;AAAA,KAEf,CAkYF,EAlrBaqB,EAkTK,OAASL;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA,IA7SzBC,EAAA,CAJCC,EAAS,CACR,KAAM,OACN,UAAYjC,IAAW,CAAE,GAAGmC,EAAgB,GAAG,KAAK,MAAMnC,GAAS,IAAI,GAAE,CAC1E,CAAA,EAJUoC,EAKX,UAAA,UAAA,CAAA,EAEYJ,EAAA,CAAXC,EAAS,CAAA,EAPCG,EAOC,UAAA,WAAA,CAAA,EACeJ,EAAA,CAA1BC,EAAS,CAAE,KAAM,MAAO,CAAA,EARdG,EAQgB,UAAA,WAAA,CAAA,EACRJ,EAAA,CAAlBuB,EAAM,CAAA,EATInB,EASQ,UAAA,WAAA,CAAA,EACAJ,EAAA,CAAlBuB,EAAM,CAAA,EAVInB,EAUQ,UAAA,YAAA,CAAA,EACAJ,EAAA,CAAlBuB,EAAM,CAAA,EAXInB,EAWQ,UAAA,cAAA,CAAA,EACAJ,EAAA,CAAlBuB,EAAM,CAAA,EAZInB,EAYQ,UAAA,eAAA,CAAA,EACWJ,EAAA,CAA7B8B,EAAM,WAAW,CAAA,EAbP1B,EAamB,UAAA,kBAAA,CAAA,EACEJ,EAAA,CAA/B8B,EAAM,aAAa,CAAA,EAdT1B,EAcqB,UAAA,mBAAA,CAAA,EAdrBA,EAANJ,EAAA,CADNE,EAAc,UAAU,CAAA,EACZE,CAAA"}